{% extends "base.html" %}
{% block page_title %}Inventory Logs{% endblock %}
{% block page_subtitle %}History for {{ product.name }} ({{ product.barcode }}){% endblock %}

{% block content %}
<div class="mb-6">
    <a href="{{ url_for('inventory.index') }}"
        class="text-gray-400 hover:text-white transition-colors flex items-center gap-2">
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back to Inventory
    </a>
</div>

<div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden shadow-sm">
    <table class="w-full text-sm">
        <thead class="bg-gray-800/50">
            <tr class="border-b border-gray-800 text-left">
                <th class="px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">Stock Change</th>
                <th class="px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">Difference</th>
                <th class="px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">Reason</th>
                <th class="px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">Changed By</th>
                <th class="px-6 py-4 text-xs font-semibold text-gray-400 uppercase tracking-wider text-right">Date &
                    Time</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-800/60">
            {% for log in logs %}
            <tr class="hover:bg-gray-800/40 transition-colors">
                <td class="px-6 py-4 text-gray-300">
                    <div class="flex items-center gap-2">
                        <span class="text-gray-500 line-through">{{ log.old_stock }}</span>
                        <span class="text-gray-600 text-xs">&rarr;</span>
                        <span class="text-white font-mono font-medium bg-gray-800 px-2 py-0.5 rounded">{{ log.new_stock
                            }}</span>
                    </div>
                </td>
                <td class="px-6 py-4">
                    {% set diff = log.new_stock - log.old_stock %}
                    {% if diff > 0 %}
                    <span
                        class="inline-flex items-center gap-1 text-green-400 text-xs font-medium bg-green-500/10 px-2 py-1 rounded-full border border-green-500/20">
                        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M5 10l7-7m0 0l7 7m-7-7v18" />
                        </svg>
                        +{{ diff }}
                    </span>
                    {% elif diff < 0 %} <span
                        class="inline-flex items-center gap-1 text-red-400 text-xs font-medium bg-red-500/10 px-2 py-1 rounded-full border border-red-500/20">
                        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                        </svg>
                        {{ diff }}
                        </span>
                        {% else %}
                        <span class="text-gray-500 text-xs bg-gray-800 px-2 py-1 rounded">No Change</span>
                        {% endif %}
                </td>
                <td class="px-6 py-4 text-gray-300 font-medium">
                    {{ log.reason }}
                </td>
                <td class="px-6 py-4 text-gray-400">
                    <div class="flex items-center gap-2">
                        <div
                            class="w-6 h-6 rounded-full bg-brand-900/50 flex items-center justify-center text-[10px] text-brand-400 font-bold border border-brand-800">
                            {% if log.user %}{{ log.user.name[:1] }}{% else %}S{% endif %}
                        </div>
                        {% if log.user %}{{ log.user.name }}{% else %}System{% endif %}
                    </div>
                </td>
                <td class="px-6 py-4 text-right text-gray-500 text-xs font-mono">
                    {{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="px-6 py-12 text-center">
                    <div class="flex flex-col items-center justify-center">
                        <div class="w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center mb-3">
                            <svg class="w-6 h-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <p class="text-gray-500 font-medium">No history available for this product.</p>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}